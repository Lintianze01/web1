name: Update Hugo version

on:
    schedule:
        - cron: '60 1 * * *'

    workflow_dispatch:

jobs:
    updateBlowfish:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v2
            with:
              token: ${{ secrets.REPO_SCOPED_TOKEN }}
          - name: Fetch release version
            run: |
              curl -sL https://api.github.com/repos/swagger-api/swagger-ui/releases/latest | \
              jq -r ".tag_name" > release-versions/swagger-ui-latest.txt
          - name: Check for modified files
            id: git-check
            run: echo ::set-output name=modified::$([ -z "`git status --porcelain`" ] && echo "false" || echo "true")
          - name: Commit latest release version
            if: steps.git-check.outputs.modified == 'true'
            run: |
              git config --global user.name 'Your Name'
              git config --global user.email 'your-email@users.noreply.github.com'
              git commit -am "New release version"
              git push
            - name: Create Pull Request
            uses: peter-evans/create-pull-request@v6
            with:
                commit-message: Update swagger-ui to ${{ steps.swagger-ui.outputs.release_tag }}
                title: Update SwaggerUI to ${{ steps.swagger-ui.outputs.release_tag }}
                body: |
                  Updates [swagger-ui][1] to ${{ steps.swagger-ui.outputs.release_tag }}
      
                  Auto-generated by [create-pull-request][2]
      
                  [1]: https://github.com/swagger-api/swagger-ui
                  [2]: https://github.com/peter-evans/create-pull-request
                labels: dependencies, automated pr
                branch: dev